From 1fd1fa258940d8ff161bef157a461ad5a1100b24 Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Wed, 1 Jun 2016 21:38:22 +0100
Subject: neomutt-ssl_ciphers

---
 conn/config.c | 2 +-
 conn/gnutls.c | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/conn/config.c b/conn/config.c
index 46a88ae2d..5afcbcb94 100644
--- a/conn/config.c
+++ b/conn/config.c
@@ -68,7 +68,7 @@ static struct ConfigDef ConnVarsSsl[] = {
   { "certificate_file", DT_PATH|D_PATH_FILE, IP "~/.mutt_certificates", 0, NULL,
     "File containing trusted certificates"
   },
-  { "ssl_ciphers", DT_STRING, 0, 0, NULL,
+  { "ssl_ciphers", DT_STRING, IP "@SYSTEM", 0, NULL,
     "Ciphers to use when using SSL"
   },
   { "ssl_client_cert", DT_PATH|D_PATH_FILE, 0, 0, NULL,
diff --git a/conn/gnutls.c b/conn/gnutls.c
index d1ad20136..714e04702 100644
--- a/conn/gnutls.c
+++ b/conn/gnutls.c
@@ -771,6 +771,8 @@ static int tls_set_priority(struct TlsSockData *data)
   else
     buf_strcpy(priority, "NORMAL");
 
+  if (mutt_str_equal(c_ssl_ciphers, "@SYSTEM"))
+  {
   const bool c_ssl_use_tlsv1_3 = cs_subset_bool(NeoMutt->sub, "ssl_use_tlsv1_3");
   if (!c_ssl_use_tlsv1_3)
   {
@@ -788,6 +790,7 @@ static int tls_set_priority(struct TlsSockData *data)
   buf_addstr(priority, ":-VERS-TLS1.1");
   buf_addstr(priority, ":-VERS-TLS1.0");
   buf_addstr(priority, ":-VERS-SSL3.0");
+  }
 
   if (nproto == 0)
   {
